<!DOCTYPE html><html lang="en-US" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.3.3" /><meta property="og:title" content="Putting phishing data into Security Onion" /><meta property="og:locale" content="en_US" /><meta name="description" content="I wanted to add some phishing scenarios to my hunting homelab. I’m more concerned with being able to hunt on malicious emails than on stopping them, so DMARC, DKIM, and SPF are out of scope. If you have an offensive lens, you’ll want to look at something like this for an effective phishing set up." /><meta property="og:description" content="I wanted to add some phishing scenarios to my hunting homelab. I’m more concerned with being able to hunt on malicious emails than on stopping them, so DMARC, DKIM, and SPF are out of scope. If you have an offensive lens, you’ll want to look at something like this for an effective phishing set up." /><link rel="canonical" href="https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/" /><meta property="og:url" content="https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/" /><meta property="og:site_name" content="kimobu" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-07-20T00:00:00-04:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Putting phishing data into Security Onion" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2024-04-14T16:46:44-04:00","datePublished":"2023-07-20T00:00:00-04:00","description":"I wanted to add some phishing scenarios to my hunting homelab. I’m more concerned with being able to hunt on malicious emails than on stopping them, so DMARC, DKIM, and SPF are out of scope. If you have an offensive lens, you’ll want to look at something like this for an effective phishing set up.","headline":"Putting phishing data into Security Onion","mainEntityOfPage":{"@type":"WebPage","@id":"https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/"},"url":"https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/"}</script><title>Putting phishing data into Security Onion | kimobu</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="kimobu"><meta name="application-name" content="kimobu"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.15.0,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script async src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="/assets/img/avatar.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">kimobu</a></div><div class="site-subtitle font-italic">Docendo discimus</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center"> <a href="https://github.com/kimobu" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github-alt"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['kimo','kimobu.space'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a> <a href="https://infosec.exchange/@kimobu" aria-label="mastodon" target="_blank" rel="noopener"> <i class="fab fa-mastodon"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Posts </a> </span> <span>Putting phishing data into Security Onion</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Putting phishing data into Security Onion</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> Kimo B </span> <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Thu, Jul 20, 2023, 12:00 AM -0400" prep="on" > Jul 20, 2023 <i class="unloaded">2023-07-20T00:00:00-04:00</i> </span></div><div> <span> <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Sun, Apr 14, 2024, 4:46 PM -0400" prefix="Updated " > Apr 14 <i class="unloaded">2024-04-14T16:46:44-04:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1207 words">6 min</span></div></div><div class="post-content"><p>I wanted to add some phishing scenarios to my hunting homelab. I’m more concerned with being able to hunt on malicious emails than on stopping them, so <a href="https://www.cloudflare.com/learning/email-security/dmarc-dkim-spf/">DMARC, DKIM, and SPF</a> are out of scope. If you have an offensive lens, you’ll want to look at something like <a href="https://www.securesystems.de/blog/building-a-red-team-infrastructure-in-2023/">this</a> for an effective phishing set up.</p><p>Let’s look at two areas: external mail where phishing comes from and internal mail where phishes will be received.</p><h1 id="external-mail">External mail</h1><p>We need some infrastructure set up to send email. First is Postfix, a mail server. We can send email using a command line, but we might want to compose emails graphically, so we’ll install an IMAP server (dovecot) and a webmail server (Roundcube).</p><h2 id="postfix">Postfix</h2><p><a href="https://orcacore.com/install-postfix-mail-server-ubuntu-22-04/">This guide</a> was pretty solid to get Postfix up and running. To support SMTPS we’ll need a certificate:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>openssl req -newkey rsa:2048 -keyout /etc/ssl/private/mail-kvps.key.enc -x509 -days 365 -out mail-kvps.crt
openssl rsa -in /etc/ssl/private/mail-kvps.key.enc -out /etc/ssl/private/mail-kvps.key
</pre></table></code></div></div><p>Here’s an example Postfix configuration file <code class="language-plaintext highlighter-rouge">main.cf</code>. Comments are inline.</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
</pre><td class="rouge-code"><pre>smtpd_banner = $myhostname ESMTP $mail_name (Debian/GNU)
biff = no
append_dot_mydomain = no
alias_maps = hash:/etc/aliases
alias_database = hash:/etc/aliases
mydestination = mail.kvps.local, localhost.kvps.local, localhost  # What domains to receive mail for
relayhost =
mynetworks = 127.0.0.0/8 10.10.41.0/24  # What networks to relay mail from
inet_interfaces = all
recipient_delimiter = +
compatibility_level = 2
myorigin = /etc/mailname
mailbox_size_limit = 0
inet_protocols = ipv4
home_mailbox = Maildir/  # In the user's homedir, where should mail be stored
smtpd_sasl_type = dovecot
smtpd_sasl_path = private/auth
smtpd_sasl_local_domain =
smtpd_sasl_security_options = noanonymous
smtpd_sasl_tls_security_options = noanonymous
broken_sasl_auth_clients = yes
smtpd_sasl_auth_enable = yes
smtp_tls_security_level = may
smtpd_tls_security_level = may
smtp_tls_note_starttls_offer = yes
smtpd_tls_key_file = /etc/ssl/private/mail-kvps.key  # TLS key from openssl above
smtpd_tls_cert_file = /etc/ssl/certs/mail-kvps.crt   # TlS cert from openssl above
smtpd_tls_loglevel = 4
smtpd_tls_received_header = yes
myhostname = mail.kvps.local  # Who are we
smtpd_tls_auth_only = no
tls_random_source = dev:/dev/urandom
</pre></table></code></div></div><h2 id="dovecot">Dovecot</h2><p>The dovecot install is <a href="https://ubuntu.com/server/docs/mail-dovecot">straight forward</a>.</p><p>In <code class="language-plaintext highlighter-rouge">10-mail.conf</code> we set the mail_location to match Postfix:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>mail_location = maildir:~/Maildir
</pre></table></code></div></div><p>Then in <code class="language-plaintext highlighter-rouge">10-master.conf</code> we set the auth on unix_listener:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>unix_listener /var/spool/postfix/private/auth {
	mode = 0666
	user = postfix
	group = postfix
  }
</pre></table></code></div></div><p>In <code class="language-plaintext highlighter-rouge">/etc/dovecot/users</code> we can add in email addresses, passwords, and user maildirs:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>admin@paypai-support.com:{PLAIN}abc123:1001:1001::/home/vmail::userdb_mail=maildir:~/Maildir/paypai-support.com/admin
</pre></table></code></div></div><h2 id="roundcube">Roundcube</h2><p>Lastly install <a href="https://github.com/roundcube/roundcubemail/wiki/Installation">Roundcube</a>.</p><p>In <code class="language-plaintext highlighter-rouge">config.inc.php</code> we configure the following:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$config['db_dsnw'] = 'mysql://USERNAME:PASSWORD@localhost/DATABASE';
$config['imap_host'] = 'localhost:143';
$config['smtp_host'] = 'localhost:25';
$config['support_url'] = 'http://localhost';
$config['des_key'] = 'YOURKEY';
$config['plugins'] = [];
$config['language'] = 'en_US';
$config['spellcheck_engine'] = 'enchant';
</pre></table></code></div></div><h1 id="internal-mail">Internal mail</h1><p>Next is internal email. The lab is Active Directory based, so I use Exchange.</p><h2 id="exchange">Exchange</h2><p>Pull the Windows Server 2019 Standard ISO from the Microsoft EvalCenter and the Exchange 2019 ISO from <a href="https://www.microsoft.com/en-us/download/details.aspx?id=104131">here</a>. In my server (VM) I added a 100Gb drive and installed Exchange to it in D:\exchange.</p><p>Once installed, configure the Exchange server to do nothing with malicious emails.</p><h1 id="dns">DNS</h1><p>Now to send emails from External to Internal, we need to set up some DNS MX entries. On a container I run bind and configure the following in <code class="language-plaintext highlighter-rouge">named.conf.local</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>zone "kvps.local" {
	type master;
	file "/etc/bind/db.kvps.local";
};

zone "41.10.10.in-addr.arpa" {
	type master;
	file "/etc/bind/db.10";
};

zone "blue.local" {
	type master;
	file "/etc/bind/db.blue.local";
};
</pre></table></code></div></div><p>Then in <code class="language-plaintext highlighter-rouge">db.kvps.local</code> we set up records for the external mail server:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>$TTL    604800
@       IN      SOA     kvps.local. root.kvps.local. (
							  4         ; Serial
						 604800         ; Refresh
						  86400         ; Retry
						2419200         ; Expire
						 604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.kvps.local.
@       IN      A       10.10.41.103
ns      IN      A       10.10.41.103
@       IN      AAAA    ::1
@       IN      MX  1   mail.kvps.local.
mail    IN      A       10.10.41.102
</pre></table></code></div></div><p>And in <code class="language-plaintext highlighter-rouge">db.blue.local</code> we set up records for the internal mail server:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>$TTL    604800
@       IN      SOA     blue.local. root.blue.local. (
							  2         ; Serial
						 604800         ; Refresh
						  86400         ; Retry
						2419200         ; Expire
						 604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.blue.local.
@       IN      A       10.10.41.103
ns      IN      A       10.10.41.103
@       IN      AAAA    ::1
@       IN      MX  1   mail.blue.local.
mail    IN      A       10.10.41.100
</pre></table></code></div></div><p>Finally we create reverse zone records for the lab in <code class="language-plaintext highlighter-rouge">db.10</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
</pre><td class="rouge-code"><pre>$TTL    604800
@       IN      SOA     ns.kvps.local. root.ns.kvps.local. (
							  2         ; Serial
						 604800         ; Refresh
						  86400         ; Retry
						2419200         ; Expire
						 604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.kvps.local.
@       IN      PTR     kvps.local.
mail    IN      A       10.10.41.102
ns      IN      A       10.10.41.103
@       IN      MX      102     mail.kvps.local.
103.10.10       IN      PTR     ns.kvps.local.


@       IN      SOA     ns.blue.local. root.ns.blue.local. (
							  2         ; Serial
						 604800         ; Refresh
						  86400         ; Retry
						2419200         ; Expire
						 604800 )       ; Negative Cache TTL
;
@       IN      NS      ns.blue.local.
@       IN      PTR     blue.local.
mail    IN      A       10.10.41.100
ns      IN      A       10.10.41.103
@       IN      MX      100     mail.blue.local.
103.10.10       IN      PTR     ns.blue.local.
</pre></table></code></div></div><p>We can test that email gets sent with telnet:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>telnet mail.blue.local 25
MAIL FROM:&lt;newsletter@contoso.com&gt;
RCPT TO:&lt;victim@blue.local&gt;
DATA
Subject: Test from Contoso
This is a test message
</pre></table></code></div></div><h1 id="security-onion">Security Onion</h1><p>Now that we can send and receive email, lets add some data to Security Onion.</p><h2 id="security-onion-23">Security Onion 2.3</h2><h3 id="zeek">Zeek</h3><p>Zeek has plugins that let you parse email messages. One I included was smtp-url-analysis, which will extract links from email and track whether those links were visited. To add this to Security Onion’s Zeek container, we do:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>mkdir -p /opt/so/saltstack/local/salt/zeek/policy/custom
cd /tmp
git clone https://github.com/initconf/smtp-url-analysis.git
mv smtp-url-analysis/scripts/ /opt/so/saltstack/local/salt/zeek/policy/custom/
</pre></table></code></div></div><p>Then we configure <code class="language-plaintext highlighter-rouge">/opt/so/saltstack/local/pillar/minions/$SENSORNAME_$ROLE.sls</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>zeek:
  local:
    '@load':
      - custom/smtp_url/scripts
</pre></table></code></div></div><h3 id="filebeat">Filebeat</h3><p>Once Zeek is configured, we need Filebeat to pull in the dataset by adding the following to <code class="language-plaintext highlighter-rouge">/opt/so/saltstack/local/pillar/zeeklogs.sls</code>:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>	- smtpurl_links
</pre></table></code></div></div><h3 id="elasticsearch">Elasticsearch</h3><p>Finally, we need to parse data out of the Zeek logs via an Elasticsearch ingest pipeline. Create a file at <code class="language-plaintext highlighter-rouge">/opt/so/saltstack/local/salt/elasticsearch/files/ingest/smtp_urls</code> with:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre> {
	"description" : "zeek.smtpurl_links",
	"processors" : [
	  { "remove":         { "field": ["host"],     "ignore_failure": true                                                                  } },
	  { "json":       { "field": "message",           "target_field": "message2",     "ignore_failure": true  } },
	  { "rename":     { "field": "message2.host",  "target_field": "smtp.url.host",       "ignore_missing": true  } },
	  { "rename":     { "field": "message2.url",  "target_field": "smtp.url.url",       "ignore_missing": true  } },
	  { "pipeline":       { "name": "zeek.common"                                                                                   } }
	]
  }
</pre></table></code></div></div><h2 id="security-onion-24">Security Onion 2.4</h2><p>SO2.4 has changed how some things are configured.</p><h3 id="zeek-1">Zeek</h3><p>We still pull this down as previously:</p><div class="language-plaintext highlighter-rouge"><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>mkdir -p /opt/so/saltstack/local/salt/zeek/policy/custom
cd /tmp
git clone https://github.com/initconf/smtp-url-analysis.git
mv smtp-url-analysis/scripts/ /opt/so/saltstack/local/salt/zeek/policy/custom/
</pre></table></code></div></div><p>Then in SOC, navigate to Configuration -&gt; zeek -&gt; config -&gt; local -&gt; load. For your node, add <code class="language-plaintext highlighter-rouge">custom/scripts</code> as a script to be loaded.</p><h3 id="elastic-fleet">Elastic Fleet</h3><p>The Elastic Agent/Fleet replace Filebeat. The Fleet pulls the logs from <code class="language-plaintext highlighter-rouge">/nsm/zeek/logs/current/*.log</code> and uses an exclude list. We do not need to change anything here.</p><h3 id="elasticsearch-1">Elasticsearch</h3><p>This should be mostly the same. I used the name zeek.smtpurl_links to conform with the <code class="language-plaintext highlighter-rouge">zeek-logs</code> agent policy.</p></div><div class="post-tail-wrapper text-muted"><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/homelab/" class="post-tag no-text-decoration" >homelab</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Putting phishing data into Security Onion - kimobu&url=https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Putting phishing data into Security Onion - kimobu&u=https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Putting phishing data into Security Onion - kimobu&url=https://kimobu.github.io/posts/Adding-Phishing-to-the-Homelab/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i class="fa-fw fas fa-link small" onclick="copyLink()" data-toggle="tooltip" data-placement="top" title="Copy link"></i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/SecurityOnion-GPT/">SecurityOnion GPT</a><li><a href="/posts/Adding-Phishing-to-the-Homelab/">Putting phishing data into Security Onion</a><li><a href="/posts/Books-of-2022/">Recap of the books I read in 2022</a><li><a href="/posts/Books-of-2021/">Recap of the books I read in 2021</a><li><a href="/posts/Books-of-2017/">Recap of the books I read in 2017</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/school/">school</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/doh/">doh</a> <a class="post-tag" href="/tags/networking/">networking</a> <a class="post-tag" href="/tags/offsec/">offsec</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/kali/">kali</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"> <span class="pl-3 pt-2 mb-2">Contents</span><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Security-Onion-Proxmox/"><div class="card-body"> <span class="timeago small" > May 26, 2021 <i class="unloaded">2021-05-26T00:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Security Onion on Proxmox</h3><div class="text-muted small"><p> Security Onion on Proxmox I originally set up my homelab using Ovirt, but have since switched back to Proxmox. The reason for that is that the version of qemu that Ovirt ships with does not support...</p></div></div></a></div><div class="card"> <a href="/posts/log4j-JDNI-Exploitation/"><div class="card-body"> <span class="timeago small" > Dec 10, 2021 <i class="unloaded">2021-12-10T00:00:00-05:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>log4j JNDI Exploitation</h3><div class="text-muted small"><p> Situation A remote code execution (RCE) bug was found in log4j. CVE 2021-44228 has been assigned to it. The vulnerability lies in how log4j interprets Java Naming and Directory Interface (JNDI) URL...</p></div></div></a></div><div class="card"> <a href="/posts/macOS-Homelab/"><div class="card-body"> <span class="timeago small" > May 10, 2023 <i class="unloaded">2023-05-10T00:00:00-04:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Adding macOS to my security homelab</h3><div class="text-muted small"><p> This post has notes on how I added a macOS machine to my security homelab. Install macOS to Proxmox Follow this guide to install macOS onto a Proxmox cluster. This will result in an x86 based VM. ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/macOS-Homelab/" class="btn btn-outline-primary" prompt="Older"><p>Adding macOS to my security homelab</p></a> <a href="/posts/Books-of-2023/" class="btn btn-outline-primary" prompt="Newer"><p>Recap of the books I read in 2023</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2024 <a href="https://github.com/kimobu">Kimo B</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/books/">books</a> <a class="post-tag" href="/tags/homelab/">homelab</a> <a class="post-tag" href="/tags/research/">research</a> <a class="post-tag" href="/tags/school/">school</a> <a class="post-tag" href="/tags/dns/">dns</a> <a class="post-tag" href="/tags/doh/">doh</a> <a class="post-tag" href="/tags/networking/">networking</a> <a class="post-tag" href="/tags/offsec/">offsec</a> <a class="post-tag" href="/tags/ai/">ai</a> <a class="post-tag" href="/tags/kali/">kali</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.7.3/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="https://kimobu.github.io{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script>
